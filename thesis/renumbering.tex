\section{Memoizing hole instance numbering using environments}
\label{sec:renumbering}

\subsection{Issues with the current implementation}
\label{sec:current_problems}

Consider the program shown in \Cref{fig:sample_hazel_program}.

\begin{listing}
  \centering
  \begin{hminted}
let a = |$\hehole^1$| in
let b = |$\lambda$| x . { a + x + |$\hehole^2$| } in
let c = |$\hehole^3$| in
|$\hehole^4$| + b 1 + f |$\hehole^5$|
  \end{hminted}
  \caption{A seemingly innocuous Hazel program}
  \label{fig:sample_hazel_program}
\end{listing}

A performance issue appears with the existing evaluator with the program shown in \Cref{fig:hole_renumbering_problem}.

% TODO: describe performance issue

% TODO: describe the existing hole renumbering implementation

\subsection{Hole instances and closures}
\label{sec:hole_instances_and_closures}

\begin{listing}
  \centering
  \begin{hminted}
let a = |$\hehole^1$| in
let b = |$\hehole^2$| in
let c = |$\hehole^3$| in
let d = |$\hehole^4$| in
let e = |$\hehole^5$| in
let f = |$\hehole^6$| in
let g = |$\hehole^7$| in
|\dots|
let x = |$\hehole^{n}$| in
|$\hehole^{n+1}$|
  \end{hminted}
  \caption{A Hazel program that generates an exponential ($2^N$) number of total hole instances}
  \label{fig:hole_renumbering_problem}
\end{listing}

\subsection{Algorithmic concerns and a two-stage approach}
\label{sec:two-stage-renumber}

\subsection{Memoization and unification with closure post-processing}
\label{sec:renumbering_memoization}

\subsection{Differences in the hole instance numbering}
\label{sec:differences_numbering}

% two-stage to one-stage approach

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
