\section{Memoizing hole instance numbering using environments}
\label{sec:renumbering}

\begin{singlespace}
  % see: https://tex.stackexchange.com/a/110156
  \begin{figure}
    \centering
    \begin{subfigure}{\textwidth}
      \begin{mdframed}[bottomline=false]
        \input{renumber_old_bigstep}
      \end{mdframed}
    \end{subfigure}
  \end{figure}
  \begin{figure}
    \ContinuedFloat
    \begin{subfigure}{\textwidth}
      \begin{mdframed}[topline=false]
        \input{renumber_old_bigstep2}
      \end{mdframed}
    \end{subfigure}
    \caption{Big-step semantics for the previous hole instance numbering algorithm}
    \label{fig:small-step-formal}
  \end{figure}
\end{singlespace}

\subsection{Issues with the current implementation}
\label{sec:current_problems}

Consider the program shown in \Cref{fig:sample_hazel_program}.

\begin{listing}
  \centering
  \begin{hminted}
let a = /\heh1/ in
let b = /\lbd/ x . { a + x + /\heh2/ } in
let c = /\heh3/ in
/\heh4/ + b 1 + f /\heh5/
  \end{hminted}
  \caption{A seemingly innocuous Hazel program}
  \label{fig:sample_hazel_program}
\end{listing}

A performance issue appears with the existing evaluator with the program shown in \Cref{fig:hole_renumbering_problem}.

% TODO: describe performance issue

% TODO: describe the existing hole renumbering implementation

\subsection{Hole instances and closures}
\label{sec:hole_instances_and_closures}

\begin{listing}
  \centering
  \begin{hminted}
let a = /\heh1/ in
let b = /\heh2/ in
let c = /\heh3/ in
let d = /\heh4/ in
let e = /\heh5/ in
let f = /\heh6/ in
let g = /\heh7/ in
/\dots/
let x = /\heh n/ in
/\heh{n+1}/
  \end{hminted}
  \caption{A Hazel program that generates an exponential ($2^N$) number of total hole instances}
  \label{fig:hole_renumbering_problem}
\end{listing}

\subsection{Algorithmic concerns and a two-stage approach}
\label{sec:two-stage-renumber}

\subsection{Memoization and unification with closure post-processing}
\label{sec:renumbering_memoization}

\subsection{Differences in the hole instance numbering}
\label{sec:differences_numbering}

% two-stage to one-stage approach

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
